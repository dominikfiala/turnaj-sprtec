!function(s){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=s();else if("function"==typeof define&&define.amd)define([],s);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.edmondsBlossom=s()}}(function(){return function s(t,i,e){function h(n,l){if(!i[n]){if(!t[n]){var a="function"==typeof require&&require;if(!l&&a)return a(n,!0);if(o)return o(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var d=i[n]={exports:{}};t[n][0].call(d.exports,function(s){var i=t[n][1][s];return h(i?i:s)},d,d.exports,s,t,i,e)}return i[n].exports}for(var o="function"==typeof require&&require,n=0;n<e.length;n++)h(e[n]);return h}({1:[function(s,t,i){function e(s,t){var i,e=[];for(i=0;i<s;i++)e[i]=t;return e}function h(s){for(var t=[],i=0;i<s;i++)t[i]=[];return t}function o(s,t,i){for(var e=1/0,h=t;h<=i;h++)s[h]<e&&(e=s[h]);return e}function n(s,t){return t<0?s[s.length+t]:s[t]}t.exports=function(s,t){if(0===s.length)return s;var i=new l(s,t);return i.maxWeightMatching()};var l=function(s,t){this.edges=s,this.maxCardinality=t,this.nEdge=s.length,this.init()};l.prototype.maxWeightMatching=function(){for(var s=0;s<this.nVertex;s++){this.label=e(2*this.nVertex,0),this.bestEdge=e(2*this.nVertex,-1),this.blossomBestEdges=h(2*this.nVertex),this.allowEdge=e(this.nEdge,!1),this.queue=[];for(var t=0;t<this.nVertex;t++)this.mate[t]===-1&&0===this.label[this.inBlossom[t]]&&this.assignLabel(t,1,-1);for(var i=!1;;){for(;this.queue.length>0&&!i;){t=this.queue.pop();for(var n=0;n<this.neighbend[t].length;n++){var l=this.neighbend[t][n],a=~~(l/2),r=this.endpoint[l];if(this.inBlossom[t]!==this.inBlossom[r]){if(!this.allowEdge[a]){var d=this.slack(a);d<=0&&(this.allowEdge[a]=!0)}if(this.allowEdge[a])if(0===this.label[this.inBlossom[r]])this.assignLabel(r,2,1^l);else if(1===this.label[this.inBlossom[r]]){var b=this.scanBlossom(t,r);if(!(b>=0)){this.augmentMatching(a),i=!0;break}this.addBlossom(b,a)}else 0===this.label[r]&&(this.label[r]=2,this.labelEnd[r]=1^l);else if(1===this.label[this.inBlossom[r]]){var m=this.inBlossom[t];(this.bestEdge[m]===-1||d<this.slack(this.bestEdge[m]))&&(this.bestEdge[m]=a)}else 0===this.label[r]&&(this.bestEdge[r]===-1||d<this.slack(this.bestEdge[r]))&&(this.bestEdge[r]=a)}}}if(i)break;var f=-1,u=[],g=[],p=[];for(this.maxCardinality||(f=1,u=o(this.dualVar,0,this.nVertex-1)),t=0;t<this.nVertex;t++)if(0===this.label[this.inBlossom[t]]&&this.bestEdge[t]!==-1){var v=this.slack(this.bestEdge[t]);(f===-1||v<u)&&(u=v,f=2,g=this.bestEdge[t])}for(m=0;m<2*this.nVertex;m++)this.blossomParent[m]===-1&&1===this.label[m]&&this.bestEdge[m]!==-1&&(d=this.slack(this.bestEdge[m]),v=d/2,(f===-1||v<u)&&(u=v,f=3,g=this.bestEdge[m]));for(m=this.nVertex;m<2*this.nVertex;m++)this.blossomBase[m]>=0&&this.blossomParent[m]===-1&&2===this.label[m]&&(f===-1||this.dualVar[m]<u)&&(u=this.dualVar[m],f=4,p=m);for(f===-1&&(f=1,u=Math.max(0,o(this.dualVar,0,this.nVertex-1))),t=0;t<this.nVertex;t++){var E=this.label[this.inBlossom[t]];1===E?this.dualVar[t]-=u:2===E&&(this.dualVar[t]+=u)}for(m=this.nVertex;m<2*this.nVertex;m++)this.blossomBase[m]>=0&&this.blossomParent[m]===-1&&(1===this.label[m]?this.dualVar[m]+=u:2===this.label[m]&&(this.dualVar[m]-=u));if(1===f)break;if(2===f){this.allowEdge[g]=!0;var B=this.edges[g][0],x=this.edges[g][1],c=this.edges[g][2];0===this.label[this.inBlossom[B]]&&(B^=x,x^=B,B^=x),this.queue.push(B)}else 3===f?(this.allowEdge[g]=!0,B=this.edges[g][0],x=this.edges[g][1],c=this.edges[g][2],this.queue.push(B)):4===f&&this.expandBlossom(p,!1)}if(!i)break;for(m=this.nVertex;m<2*this.nVertex;m++)this.blossomParent[m]===-1&&this.blossomBase[m]>=0&&1===this.label[m]&&0===this.dualVar[m]&&this.expandBlossom(m,!0)}for(t=0;t<this.nVertex;t++)this.mate[t]>=0&&(this.mate[t]=this.endpoint[this.mate[t]]);for(t=0;t<this.nVertex;t++);return this.mate},l.prototype.slack=function(s){var t=this.edges[s][0],i=this.edges[s][1],e=this.edges[s][2];return this.dualVar[t]+this.dualVar[i]-2*e},l.prototype.blossomLeaves=function(s){if(s<this.nVertex)return[s];for(var t=[],i=this.blossomChilds[s],e=0;e<i.length;e++)if(i[e]<=this.nVertex)t.push(i[e]);else for(var h=this.blossomLeaves(i[e]),o=0;o<h.length;o++)t.push(h[o]);return t},l.prototype.assignLabel=function(s,t,i){var e=this.inBlossom[s];if(this.label[s]=this.label[e]=t,this.labelEnd[s]=this.labelEnd[e]=i,this.bestEdge[s]=this.bestEdge[e]=-1,1===t)this.queue.push.apply(this.queue,this.blossomLeaves(e));else if(2===t){var h=this.blossomBase[e];this.assignLabel(this.endpoint[this.mate[h]],1,1^this.mate[h])}},l.prototype.scanBlossom=function(s,t){for(var i=[],e=-1;s!==-1||t!==-1;){var h=this.inBlossom[s];if(4&this.label[h]){e=this.blossomBase[h];break}i.push(h),this.label[h]=5,this.labelEnd[h]===-1?s=-1:(s=this.endpoint[this.labelEnd[h]],h=this.inBlossom[s],s=this.endpoint[this.labelEnd[h]]),t!==-1&&(s^=t,t^=s,s^=t)}for(var o=0;o<i.length;o++)h=i[o],this.label[h]=1;return e},l.prototype.addBlossom=function(s,t){var i=this.edges[t][0],h=this.edges[t][1],o=this.edges[t][2],n=this.inBlossom[s],l=this.inBlossom[i],a=this.inBlossom[h];b=this.unusedBlossoms.pop(),this.blossomBase[b]=s,this.blossomParent[b]=-1,this.blossomParent[n]=b,path=this.blossomChilds[b]=[];for(var r=this.blossomEndPs[b]=[];l!==n;)this.blossomParent[l]=b,path.push(l),r.push(this.labelEnd[l]),i=this.endpoint[this.labelEnd[l]],l=this.inBlossom[i];for(path.push(n),path.reverse(),r.reverse(),r.push(2*t);a!==n;)this.blossomParent[a]=b,path.push(a),r.push(1^this.labelEnd[a]),h=this.endpoint[this.labelEnd[a]],a=this.inBlossom[h];this.label[b]=1,this.labelEnd[b]=this.labelEnd[n],this.dualVar[b]=0;for(var d=this.blossomLeaves(b),m=0;m<d.length;m++)i=d[m],2===this.label[this.inBlossom[i]]&&this.queue.push(i),this.inBlossom[i]=b;var f=e(2*this.nVertex,-1);for(m=0;m<path.length;m++){if(l=path[m],0===this.blossomBestEdges[l].length){var u=[];d=this.blossomLeaves(l);for(var g=0;g<d.length;g++){i=d[g],u[g]=[];for(var p=0;p<this.neighbend[i].length;p++){var v=this.neighbend[i][p];u[g].push(~~(v/2))}}}else u=[this.blossomBestEdges[l]];for(g=0;g<u.length;g++){var E=u[g];for(p=0;p<E.length;p++){t=E[p];var B=this.edges[t][0],x=this.edges[t][1];o=this.edges[t][2],this.inBlossom[x]===b&&(B^=x,x^=B,B^=x);var c=this.inBlossom[x];c!==b&&1===this.label[c]&&(f[c]===-1||this.slack(t)<this.slack(f[c]))&&(f[c]=t)}}this.blossomBestEdges[l]=[],this.bestEdge[l]=-1}var V=[];for(m=0;m<f.length;m++)t=f[m],t!==-1&&V.push(t);for(this.blossomBestEdges[b]=V,this.bestEdge[b]=-1,m=0;m<this.blossomBestEdges[b].length;m++)t=this.blossomBestEdges[b][m],(this.bestEdge[b]===-1||this.slack(t)<this.slack(this.bestEdge[b]))&&(this.bestEdge[b]=t)},l.prototype.expandBlossom=function(s,t){for(var i=0;i<this.blossomChilds[s].length;i++){var e=this.blossomChilds[s][i];if(this.blossomParent[e]=-1,e<this.nVertex)this.inBlossom[e]=e;else if(t&&0===this.dualVar[e])this.expandBlossom(e,t);else for(var h=this.blossomLeaves(e),o=0;o<h.length;o++)v=h[o],this.inBlossom[v]=e}if(!t&&2===this.label[s]){var l=this.inBlossom[this.endpoint[1^this.labelEnd[s]]],a=this.blossomChilds[s].indexOf(l);if(1&a){a-=this.blossomChilds[s].length;var r=1,d=0}else r=-1,d=1;for(var b=this.labelEnd[s];0!==a;)this.label[this.endpoint[1^b]]=0,this.label[this.endpoint[n(this.blossomEndPs[s],a-d)^d^1]]=0,this.assignLabel(this.endpoint[1^b],2,b),this.allowEdge[~~(n(this.blossomEndPs[s],a-d)/2)]=!0,a+=r,b=n(this.blossomEndPs[s],a-d)^d,this.allowEdge[~~(b/2)]=!0,a+=r;var m=n(this.blossomChilds[s],a);for(this.label[this.endpoint[1^b]]=this.label[m]=2,this.labelEnd[this.endpoint[1^b]]=this.labelEnd[m]=b,this.bestEdge[m]=-1,a+=r;n(this.blossomChilds[s],a)!==l;)if(m=n(this.blossomChilds[s],a),1!==this.label[m]){for(h=this.blossomLeaves(m),i=0;i<h.length&&(v=h[i],0===this.label[v]);i++);0!==this.label[v]&&(this.label[v]=0,this.label[this.endpoint[this.mate[this.blossomBase[m]]]]=0,this.assignLabel(v,2,this.labelEnd[v])),a+=r}else a+=r}this.label[s]=this.labelEnd[s]=-1,this.blossomEndPs[s]=this.blossomChilds[s]=[],this.blossomBase[s]=-1,this.blossomBestEdges[s]=[],this.bestEdge[s]=-1,this.unusedBlossoms.push(s)},l.prototype.augmentBlossom=function(s,t){for(var i,e,h=t;this.blossomParent[h]!==s;)h=this.blossomParent[h];if(h>this.nVertex&&this.augmentBlossom(h,t),i=e=this.blossomChilds[s].indexOf(h),1&i){e-=this.blossomChilds[s].length;var o=1,l=0}else o=-1,l=1;for(;0!==e;){e+=o,h=n(this.blossomChilds[s],e);var a=n(this.blossomEndPs[s],e-l)^l;h>=this.nVertex&&this.augmentBlossom(h,this.endpoint[a]),e+=o,h=n(this.blossomChilds[s],e),h>=this.nVertex&&this.augmentBlossom(h,this.endpoint[1^a]),this.mate[this.endpoint[a]]=1^a,this.mate[this.endpoint[1^a]]=a}this.blossomChilds[s]=this.blossomChilds[s].slice(i).concat(this.blossomChilds[s].slice(0,i)),this.blossomEndPs[s]=this.blossomEndPs[s].slice(i).concat(this.blossomEndPs[s].slice(0,i)),this.blossomBase[s]=this.blossomBase[this.blossomChilds[s][0]]},l.prototype.augmentMatching=function(s){for(var t=this.edges[s][0],i=this.edges[s][1],e=0;e<2;e++){if(0===e)var h=t,o=2*s+1;else h=i,o=2*s;for(;;){var n=this.inBlossom[h];if(n>=this.nVertex&&this.augmentBlossom(n,h),this.mate[h]=o,this.labelEnd[n]===-1)break;var l=this.endpoint[this.labelEnd[n]],a=this.inBlossom[l];h=this.endpoint[this.labelEnd[a]];var r=this.endpoint[1^this.labelEnd[a]];a>=this.nVertex&&this.augmentBlossom(a,r),this.mate[r]=this.labelEnd[a],o=1^this.labelEnd[a]}}},l.prototype.init=function(){this.nVertexInit(),this.maxWeightInit(),this.endpointInit(),this.neighbendInit(),this.mate=e(this.nVertex,-1),this.label=e(2*this.nVertex,0),this.labelEnd=e(2*this.nVertex,-1),this.inBlossomInit(),this.blossomParent=e(2*this.nVertex,-1),this.blossomChilds=h(2*this.nVertex),this.blossomBaseInit(),this.blossomEndPs=h(2*this.nVertex),this.bestEdge=e(2*this.nVertex,-1),this.blossomBestEdges=h(2*this.nVertex),this.unusedBlossomsInit(),this.dualVarInit(),this.allowEdge=e(this.nEdge,!1),this.queue=[]},l.prototype.blossomBaseInit=function(){for(var s=[],t=0;t<this.nVertex;t++)s[t]=t;var i=e(this.nVertex,-1);this.blossomBase=s.concat(i)},l.prototype.dualVarInit=function(){var s=e(this.nVertex,this.maxWeight),t=e(this.nVertex,0);this.dualVar=s.concat(t)},l.prototype.unusedBlossomsInit=function(){var s,t=[];for(s=this.nVertex;s<2*this.nVertex;s++)t.push(s);this.unusedBlossoms=t},l.prototype.inBlossomInit=function(){var s,t=[];for(s=0;s<this.nVertex;s++)t[s]=s;this.inBlossom=t},l.prototype.neighbendInit=function(){var s,t,i,e=h(this.nVertex);for(s=0;s<this.nEdge;s++)t=this.edges[s][0],i=this.edges[s][1],e[t].push(2*s+1),e[i].push(2*s);this.neighbend=e},l.prototype.endpointInit=function(){var s,t=[];for(s=0;s<2*this.nEdge;s++)t[s]=this.edges[~~(s/2)][s%2];this.endpoint=t},l.prototype.nVertexInit=function(){for(var s=0,t=0;t<this.nEdge;t++){var i=this.edges[t][0],e=this.edges[t][1];i>=s&&(s=i+1),e>=s&&(s=e+1)}this.nVertex=s},l.prototype.maxWeightInit=function(){for(var s=0,t=0;t<this.nEdge;t++){var i=this.edges[t][2];i>s&&(s=i)}this.maxWeight=s}},{}]},{},[1])(1)});